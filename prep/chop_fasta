#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Sep 11 11:36:25 2023

@author: atallahyuneska
"""

def read_fasta(file_path):
    """
    Reads a FASTA file and returns a dictionary where keys are sequence IDs and values are sequences.
    """
    sequences = {}
    current_id = None
    with open(file_path, "r") as fasta_file:
        for line in fasta_file:
            line = line.strip()
            if line.startswith(">"):
                current_id = line[1:]
                sequences[current_id] = ""
            elif current_id is not None:
                sequences[current_id] += line
    return sequences

def extract_subsequence(sequence, start_index, end_index):
    """
    Extracts a subsequence from the given sequence based on start and end indices.
    """
    return sequence[start_index - 1:end_index]  # Adjust for 0-based indexing

def main(input_file, output_file, start_index, end_index):
    # Read the FASTA file
    fasta_sequences = read_fasta(input_file)

    # Check if there is at least one sequence in the file
    if not fasta_sequences:
        print("No sequences found in the FASTA file.")
        return

    # Extract the first sequence and its ID
    first_sequence_id, first_sequence = list(fasta_sequences.items())[0]

    # Extract the subsequence
    subsequence = extract_subsequence(first_sequence, start_index, end_index)

    # Write the subsequence to the output file
    with open(output_file, "w") as output:
        output.write(f">{first_sequence_id}\n")
        output.write(subsequence)

if __name__ == "__main__":
    input_file = "/your/path/"  # Replace with the path to your input FASTA file
    output_file = "your/path/"  # Replace with the desired output file path
    start_index = 1  # Replace with the starting amino acid index
    end_index = 1  # Replace with the ending amino acid index

    main(input_file, output_file, start_index, end_index)
